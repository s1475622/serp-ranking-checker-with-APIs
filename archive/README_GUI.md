# SERP 排名追蹤器 - GUI 版本

## 🚀 快速開始

雙擊 **`run_gui.bat`** 即可啟動圖形介面

## ✨ 主要特色

### 1. 友善的圖形介面
- 不需要記指令
- 所有設定都有視覺化選項
- 即時顯示執行過程
- 自動儲存設定

### 2. 完整功能
- ✅ 3 種 API 服務選擇（SERP API / Scrapingdog / Apify）
- ✅ 多地區搜尋（US / TW / HK，可多選）
- ✅ 目標網域設定（套用到所有關鍵字）
- ✅ 關鍵字檔案選擇（支援瀏覽）
- ✅ API 金鑰管理（可直接更新）
- ✅ 即時執行紀錄（自動處理中文編碼）
- ✅ 隨時停止執行
- ✅ 快速開啟結果資料夾

### 3. 智慧編碼處理
- 自動偵測系統編碼
- 支援 UTF-8, Big5, GBK 等多種編碼
- 中文輸出不會亂碼

## 📋 使用步驟

### 首次使用

1. **啟動程式**
   ```
   雙擊 run_gui.bat
   ```

2. **檢查 API 金鑰**
   - 程式會自動載入 config.py 中的 API 金鑰
   - 如需更新，直接在界面中修改並點擊「更新」

3. **設定搜尋參數**
   - 選擇 API 服務（預設：SERP API）
   - 勾選搜尋地區（預設：台灣）
   - 確認目標網域（預設：mall.sfworldwide.com）
   - 選擇關鍵字檔案（預設：keywords.csv）

4. **測試輸出功能**
   - 點擊「測試輸出」按鈕
   - 確認執行紀錄區能正常顯示

5. **開始搜尋**
   - 點擊「開始搜尋」
   - 觀察執行紀錄區的即時輸出

### 日常使用

1. 啟動 `run_gui.bat`
2. 程式會自動載入上次的設定
3. 確認設定無誤後，點擊「開始搜尋」
4. 完成後點擊「開啟結果資料夾」查看結果

## 🎯 介面說明

### API 服務選擇
- **SERP API（推薦）**：穩定可靠，免費每月 100 次查詢
- **Scrapingdog API**：提供免費試用方案
- **Apify API**：適合大量爬取需求

### 搜尋地區
- **美國 (US)**：英文搜尋，google.com
- **台灣 (TW)**：繁體中文搜尋，google.com.tw
- **香港 (HK)**：繁體中文搜尋，google.com.hk
- 可同時選擇多個地區

### 目標網域
- 所有關鍵字都使用此網域進行排名追蹤
- keywords.csv 不需要 domain 欄位
- 更換網域只需修改此欄位

### 關鍵字檔案
- 預設：keywords.csv
- 點擊「瀏覽...」可選擇其他檔案
- CSV 格式，只需 `keyword` 欄位

### API 金鑰設定
- 可以直接在 GUI 中更新
- 更新後會寫入 config.py
- Apify 使用環境變數，需重啟程式

### 控制按鈕
- **開始搜尋**：開始執行爬蟲
- **停止**：中斷執行（執行中才可用）
- **開啟結果資料夾**：快速開啟 results 資料夾
- **測試輸出**：測試即時輸出功能

### 執行紀錄
- 顯示所有執行過程
- 每行前面有時間戳記
- 自動捲動到最新訊息
- 支援捲動查看歷史記錄

## 💡 使用技巧

### 1. 設定會自動儲存
每次點擊「開始搜尋」時，會自動儲存：
- API 服務類型
- 搜尋地區
- 目標網域
- 關鍵字檔案路徑

下次開啟程式會自動載入這些設定。

### 2. 網域管理
- 不需要在 keywords.csv 中設定 domain
- 所有關鍵字共用 GUI 中設定的網域
- 更換網域非常方便

### 3. 即時監控
- 執行紀錄會即時顯示進度
- 可以看到每個關鍵字的搜尋狀態
- API 配額警告會立即顯示

### 4. 多地區搜尋
- 可同時勾選多個地區
- 節省操作時間
- 結果會分別記錄

## 🔧 進階功能

### API 金鑰更新
1. 在對應欄位輸入新的 API 金鑰
2. 點擊「更新」按鈕
3. 系統會自動寫入 config.py

### 關鍵字檔案選擇
1. 點擊「瀏覽...」按鈕
2. 選擇 CSV 檔案
3. 確保 CSV 包含 `keyword` 欄位

### 測試輸出功能
- 用於驗證即時輸出是否正常
- 會執行 test_output.py
- 應該看到 5 行訊息逐步出現

## ❓ 常見問題

**Q: 看不到執行過程怎麼辦？**
A:
1. 先點擊「測試輸出」驗證功能
2. 確認執行紀錄區在視窗下方
3. 已加入多重編碼支援

**Q: 中文顯示亂碼？**
A: 程式已自動處理編碼問題，會嘗試：
- UTF-8
- 系統預設編碼（Windows 中文版通常是 cp950）
- Big5
- GBK

**Q: keywords.csv 需要 domain 欄位嗎？**
A: 不需要！只要 `keyword` 欄位即可，所有關鍵字使用 GUI 設定的網域。

**Q: 如何更換網域？**
A: 直接在「目標網域」欄位修改，點擊「開始搜尋」會自動儲存。

**Q: 設定會保留嗎？**
A: 會！每次開始搜尋時自動儲存到 gui_settings.json。

**Q: 可以同時追蹤多個網域嗎？**
A: 目前設計是所有關鍵字使用同一網域。如需追蹤多個網域，請分次執行。

**Q: 執行中可以停止嗎？**
A: 可以！點擊「停止」按鈕即可中斷。

**Q: 結果儲存在哪裡？**
A: results 資料夾，點擊「開啟結果資料夾」可快速開啟。

## 📁 相關檔案

- `gui_app.py` - GUI 主程式
- `run_gui.bat` - 啟動程式
- `gui_settings.json` - 設定檔（自動生成）
- `test_output.py` - 測試腳本
- `encoding_helper.py` - 編碼處理工具

## 🔄 版本資訊

**目前版本：V2**

改進內容：
- ✅ 修正右邊空白問題（使用 pack 佈局）
- ✅ 解決中文亂碼（多重編碼自動偵測）
- ✅ 完整 API 金鑰管理
- ✅ 即時輸出顯示
- ✅ 自動儲存設定

備份檔案：
- `gui_app_old.py` - 舊版 GUI（使用 grid 佈局）
- `run_gui_old.bat` - 舊版啟動檔

## 📞 技術支援

如遇問題，請檢查：
1. Python 是否正確安裝
2. 必要套件是否已安裝（tkinter, pandas, requests 等）
3. config.py 中的 API 金鑰是否有效
4. keywords.csv 格式是否正確

## 🎉 享受使用！

有了 GUI 版本，追蹤 SERP 排名變得更簡單了！
